Bootstrap: docker
From: lcazenille/ubuntupysshgcc


%labels
    Author leo.cazenille@gmail.com
    Version 0.1.0

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export DEBIAN_FRONTEND=noninteractive

%files
    requirements.txt
    nupack3.2.2.tar.gz

%post
    apt-get update
    apt-get install -o Dpkg::Options::="--force-confdef" -o Dpkg::Options::="--force-confold" -yqq graphviz git libtiff5-dev libjpeg-turbo8-dev zlib1g-dev libfreetype6-dev liblcms2-dev libwebp-dev
    #pip3 install -U -r requirements.txt

    # Install peppercorn
    pip install mpmath==0.19 numpy scipy sympy==1.2 networkx matplotlib==2.2.4
    pip3 install tqdm colorama psutil parse powerlaw networkx matplotlib==2.2.4 seaborn graphviz pydot
    pip3 install -U qdpy==0.1.0
    git clone https://github.com/leo-cazenille/peppercornenumerator.git
    cd peppercornenumerator && python2 setup.py install
    cd ..

    # Install nupack
    tar xvf nupack3.2.2.tar.gz
    cd nupack3.2.2
    mkdir build && cd build
    cmake .. && make -j 10
    make install


%runscript
    exec $@

%apprun illuminate
    exec ./scripts/illuminate.py $@

%apprun runAllExpes
    exec ./scripts/runAllExpes.sh

%apprun mkAllPlots
    exec ./scripts/mkAllPlots.py

